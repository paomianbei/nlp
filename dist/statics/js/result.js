$(function(){var t,e,n,i,o,a,l,s,r=[],h=[],c=[],p=[],u=[],m=[],y=[],g=new Vue({data:{inputText:"",contentStyle:!0,titleStyle:!1,innerData:[],innerColor:[],outData:[],outColor:[],show:!1,zfShow:!1,loading:!1},methods:{contentChange:function(){a=this.inputText,this.contentStyle=!0,this.titleStyle=!1,this.show=!1,this.loading=!0,$("#chinese").html(""),$(".zf-analysis").css("display","block"),$("#chinese").html(e),$(".title-relation").hide(),$(".cont-relation").show(),this.inputText=o},titleChange:function(){o=this.inputText,this.contentStyle=!1,this.titleStyle=!0,this.show=!0,this.loading=!1,$("#chinese").html(""),$(".zf-analysis").css("display","none"),$("#chinese").html(n),$(".title-relation").show(),$(".cont-relation").hide(),this.inputText=a},empty:function(){this.inputText="",this.titleStyle?(n="",$("#chinese").html(n),$("#entityContent").html(""),l.clear(),s.clear()):this.contentStyle&&(e="",$(".smile-percent").html("50"),$(".cry-percent").html("50"),$(".smile-show").css("width","50%"),$(".cry-show").css("width","50%"),$("#chinese").html(e),t.clear())},submit:function(){""==this.inputText?this.empty():(this.contentStyle&&(o=g.inputText,""==this.inputText&&($(".smile-percent").html("50"),$(".cry-percent").html("50"),$(".smile-show").css("width","50%"),$(".cry-show").css("width","50%")),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/getContentSegment",data:{text:this.inputText},success:function(t){for(var n="",i=0;i<t.map.length;i++)t.map[i]=t.map[i].trim(),n+="<span>"+t.map[i]+"</span>";e=n,$("#chinese").html(n)}}),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/getSentiment",data:{text:this.inputText},success:function(t){var e=Math.round(100*t.map[1].toFixed(2)),n=100-e;$(".smile-percent").html(e),$(".cry-percent").html(n),$(".smile-show").css("width",e+"%"),$(".cry-show").css("width",n+"%")},error:function(){}}),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/getNewsWordVector",data:{text:g.inputText},success:function(e){p.length=0;var n,i=[],o=0;for(var a in e.map){p.push({category:0,id:o,name:a,symbol:"circle",symbolSize:50,itemStyle:{normal:{color:"#333333",label:{show:!0,textStyle:{color:"#fff"}}}}}),n=o,o++,m.push([{name:a}]),i.push(n),m.push([{name:a}]),u.push({source:n,target:i[i.length-2]});for(var l=0;l<e.map[a].length&&(p.push({category:1,id:o,name:e.map[a][l],symbol:"circle",symbolSize:40,itemStyle:{normal:{color:"#ffae00",label:{show:!0,textStyle:{color:"#333"}}}}}),!(l>8));l++)m.push([{name:e.map[a][l]}]),u.push({source:o,target:n}),o++}var s={tooltip:{show:!0,trigger:"axis"},color:["#ff7f50","#87cefa"],animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"force",xAxisIndex:10,yAxisIndex:10,draggable:!0,roam:!1,initial:[580,400],fixX:!0,fixY:!0,force:{gravity:.05,edgeLength:100,repulsion:70,layoutAnimation:!0},itemStyle:{normal:{label:{show:!0,textStyle:{color:"#000"}},edgeLength:200,borderType:"solid",borderWidth:2,opacity:1}},lineStyle:{normal:{color:"#999999",width:"1",type:"solid",curveness:.3,opacity:1}},data:p,categories:m,links:u}]};$("#relationC").css("height",100*i.length+"px"),t=echarts.init(document.getElementById("relationC")),t.setOption(s),t.resize()}})),this.titleStyle&&(a=g.inputText,$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/segment",data:{text:this.inputText},success:function(t){for(var e="",i=0;i<t.list.length;i++)e+="<span>"+t.list[i]+"</span>";n=e,$("#chinese").html(e)}}),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/identify",data:{text:this.inputText},success:function(t){html="";for(var e in t.list)for(var n in t.list[e])html+='<span class="text-'+t.list[e][n]+'">'+n+"</span>";$("#entityContent").html(html)},error:function(){}}),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/getWordVector",data:{text:g.inputText},success:function(t){r.length=0;var e,n,o,a,l,p=[],u=0;for(var m in t.map){r.push({category:0,id:u,name:m,symbol:"circle",symbolSize:50,itemStyle:{normal:{color:"#333333",label:{show:!0,textStyle:{color:"#fff"}}}}}),e=u,u++,c.push([{name:m}]),p.push(e),c.push([{name:m}]),h.push({source:e,target:p[p.length-2]}),n=t.map[m].BRAND.length,o=t.map[m].CORE.length,n+o<=10?(a=n,l=o):n>=5&&o>=5?(a=5,l=5):n>5&&o<5?(a=10-o,l=o):n<5&&o>5&&(a=n,l=10-n);for(var y=0;y<a;y++)r.push({category:1,id:u,name:t.map[m].BRAND[y],symbol:"circle",symbolSize:40,itemStyle:{normal:{color:"#cc286a",label:{show:!0,textStyle:{color:"#333"}}}}}),c.push([{name:t.map[m].BRAND[y]}]),h.push({source:u,target:e}),u++;for(var y=0;y<l;y++)r.push({category:1,id:u,name:t.map[m].CORE[y],symbol:"circle",symbolSize:40,itemStyle:{normal:{color:"#ffae00",label:{show:!0,textStyle:{color:"#333"}}}}}),c.push([{name:t.map[m].CORE[y]}]),h.push({source:u,target:e}),u++}i={tooltip:{show:!0,trigger:"axis"},color:["#ff7f50","#87cefa"],animationDuration:1500,animationEasingUpdate:"quinticInOut",series:[{type:"graph",layout:"force",xAxisIndex:10,yAxisIndex:10,draggable:!0,roam:!1,initial:[580,400],fixX:!0,fixY:!0,force:{gravity:.05,edgeLength:100,repulsion:70,layoutAnimation:!0},itemStyle:{normal:{label:{show:!0,textStyle:{}},edgeLength:200,borderType:"solid",borderWidth:2,opacity:1}},lineStyle:{normal:{color:"#999999",width:"1",type:"solid",curveness:.3,opacity:1}},data:r,categories:c,links:h}]},$("#relationT").css("height",200*p.length+"px"),s=echarts.init(document.getElementById("relationT")),s.setOption(i),s.resize()}}),$.ajax({type:"POST",url:"http://10.112.75.12:8081/nlp/getClassify",data:{text:this.inputText},beforeSend:function(){g.loading=!0},success:function(t){y.length=0;for(var e in t.map)y.push({value:t.map[e],name:e});y=y.sort(function(t,e){return t.value<e.value?1:-1}),g.innerData.length=0,g.outData.length=0,g.outColor.length=0,g.innerColor.length=0;for(var e=0;e<y.length;e++){var n={value:1,name:y[e].name};e<2&&(n.name+="\n"+y[e].value.toFixed(2)),e%2==0?(g.outData.push(n),g.outColor.push("#1593e7")):(g.innerData.push(n),g.innerColor.push("#1568c9"))}g.innerColor[0]=g.outColor[0]="#d43f39",g.outData[0].value=g.innerData[0].value=2,$("#textClassify").css("height","400px"),l=echarts.init(document.getElementById("textClassify"));var i={legend:{orient:"vertical"},series:[{name:"访问来源",type:"pie",center:["50%","50%"],label:{normal:{position:"inner",offset:[30,40],textStyle:{fontSize:"12",fontWeight:"normal"}}},labelLine:{smooth:1,length:1},type:"pie",radius:["10%","50%"],color:g.innerColor,data:g.innerData},{name:"访问来源",type:"pie",radius:["60%","90%"],label:{normal:{position:"inner",textStyle:{fontSize:"12",fontWeight:"normal"}}},color:g.outColor,data:g.outData}]};l.setOption(i),g.loading=!1},error:function(){}})))}}}).$mount("#app")});